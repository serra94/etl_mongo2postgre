version: '3'

services:
    mongo_db:
      container_name: mongodb
      image: mongo:latest
      expose:
        - 27017
      ports:
        - "27017:27017"
      volumes:
        - mongo_data:/data/db
        - ./etl_tools/mongodb_simulator/data:/collections_data
        - ./script/01-rs-initiate.js:/docker-entrypoint-initdb.d/01-rs-initiate.js
        - ./script/02-entrypoint.sh:/docker-entrypoint-initdb.d/02-entrypoint.sh
      command: ["--replSet", "dbrs", "--bind_ip_all"]

    rabbitmq:
      image: "rabbitmq:3-management"
      container_name: "rabbitmq"
      ports:
        - "5672:5672"
        - "15672:15672" 
      
      environment:
        RABBITMQ_DEFAULT_USER: "admin"
        RABBITMQ_DEFAULT_PASS: "admin"

volumes:
  mongo_data:
  postgres_data: